!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.graph=e():t.graph=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=a(n(3)),o=a(n(6));function a(t){return t&&t.__esModule?t:{default:t}}var s=Math.PI/180,u=wx.getSystemInfoSync().pixelRatio,l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this._x=null==e.x?0:e.x,this._y=null==e.y?0:e.y,this._width=null==e.width?0:e.width,this._height=null==e.height?0:e.height,this._anchor=null==e.anchor?{x:.5,y:.5}:e.anchor,this._rotate=null==e.rotate?0:e.rotate,this._scaleX=null==e.scaleX?1:e.scaleX,this._scaleY=null==e.scaleY?1:e.scaleY,this.opacity=null==e.opacity?1:e.opacity,this._hidden=null!=e.hidden&&e.hidden,this._clip=null!=e.clip&&e.clip,this._children=[],this._transformDirty=!0,this._contentDirty=!0,this._currentTransformMatrix=new r.default,this._parent}return i(t,[{key:"centerMe",value:function(t){null==t&&(t=this._parent),null!=t&&(this.x=Math.floor((t.width-this.width)/2),this.y=Math.floor((t.height-this.height)/2))}},{key:"addChild",value:function(t){if(null!=t._parent)throw new Error("子节点不能同时挂在多个父节点下,请先将该子节点从原父节点移除后再添加");this._children.push(t),t._parent=this}},{key:"removeChild",value:function(t){this.removeChildAt(this._children.indexOf(t))}},{key:"removeChildAt",value:function(t){if(!(t<0||t>this._children.length-1)){var e=this._children.splice(t,1);null!=e&&1==e.length&&(e[0]._parent=null)}}},{key:"_drawSelf",value:function(t,e,n){}},{key:"_drawChildren",value:function(t){this._children.forEach(function(e){return e.draw(t)})}},{key:"canDraw",value:function(){return 0!=this.width&&0!=this.height&&0!=this.opacity&&!this.hidden}},{key:"draw",value:function(t){this.canDraw()&&(t.save(),this._applyCurrentTransform(t),this._applyCurrentDrawingStates(t),this._drawSelf(t,this.width,this.height),this._drawChildren(t),t.restore())}},{key:"_applyCurrentDrawingStates",value:function(t){t.globalAlpha=this.opacity}},{key:"_calculateTransformMatrix",value:function(){var t=this._currentTransformMatrix;if(this._transformDirty){var e=r.default.TEMP;t=t.translate(this.x,this.y);var n=this.anchor.x*this.width,i=this.anchor.y*this.height;0!==this.rotate&&(t=(t=(t=t.multiply(e.translate(n,i))).multiply(e.rotate(this.rotate*s))).multiply(e.translate(-n,-i))),1===this.scaleX&&1===this.scaleY||(t=(t=t.multiply(e.scale(this.scaleX,this.scaleY))).multiply(e.translate(n/this.scaleX-n,i/this.scaleY-i))),this._transformDirty=!1}return t}},{key:"_applyCurrentTransform",value:function(t){var e=this._calculateTransformMatrix().data;t.transform(e[0],e[3],e[1],e[4],e[2],e[5])}},{key:"getRoot",value:function(){for(var t=this;null!=t._parent;)t=t._parent;return t}},{key:"pointInMe",value:function(t,e,n){if(null==t||null==e)return null;var i=this._calculateTransformMatrix(),a=r.default.IdentityMatrix();null!=n?(r.default.copyFrom(n,a),a.multiply(i)):r.default.copyFrom(i,a);for(var s=this.getVertex(),u=0;u<s.length;u++)a.multiplyWithVertex(s[u],s[u]);if(!o.default.isPointInPolygon(t,e,s))return null;for(var l=this,h=this._children.length-1;h>=0;h--){var c=this._children[h].pointInMe(t,e,a);if(null!=c){l=c;break}}return l}},{key:"getVertex",value:function(){return[[0,0],[this.width,0],[this.width,this.height],[0,this.height]]}},{key:"clip",get:function(){return this._clip},set:function(t){this._clip=t}},{key:"hidden",set:function(t){this._hidden=t},get:function(){return this._hidden}},{key:"scaleX",get:function(){return this._scaleX},set:function(t){this._scaleX!=t&&(this._scaleX=t,this._transformDirty=!0)}},{key:"scaleY",get:function(){return this._scaleY},set:function(t){this._scaleY!=t&&(this._scaleY=t,this._transformDirty=!0)}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate!=t&&(this._rotate=t,Math.abs(this._rotate)>=360&&(this._rotate=this._rotate%360),this._transformDirty=!0)}},{key:"anchor",get:function(){return this._anchor}},{key:"anchorX",set:function(t){this._anchor.x!=t&&(this._anchor.x=t,this._transformDirty=!0)}},{key:"anchorY",set:function(t){this._anchor.y!=t&&(this._anchor.y=t,this._transformDirty=!0)}},{key:"left",get:function(){return this.x}},{key:"top",get:function(){return this.y}},{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"x",get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this._transformDirty=!0)}},{key:"y",get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this._transformDirty=!0)}},{key:"width",get:function(){return this._width},set:function(t){this._width!=t&&(this._width=t,this._contentDirty=!0)}},{key:"height",get:function(){return this._height},set:function(t){this._height!=t&&(this._height=t,this._contentDirty=!0)}},{key:"children",get:function(){return this._children}}],[{key:"PIDIV180",get:function(){return s}},{key:"DRP",get:function(){return u}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(0),s=(i=a)&&i.__esModule?i:{default:i};var u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{};var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.color=null==t.color?"#000000":t.color,n.borderColor=t.borderColor,n.borderWidth=null==t.borderWidth?0:t.borderWidth,n.borderStyle=null==t.borderWidth?"solid":t.borderWidth,n._path2D=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),r(e,[{key:"_applyCurrentDrawingStates",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_applyCurrentDrawingStates",this).call(this,t),t.fillStyle=this.color,t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth}},{key:"canDraw",value:function(){return(null!=this.color||null!=this.strokeColor&&0!=this.borderWidth)&&o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"canDraw",this).call(this)}},{key:"_drawSelf",value:function(t,e,n){this._contentDirty&&(this._path2D=t.wx_canvas.createPath2D(),this._path2D&&null==this._path2D.beginPath&&(this._path2D=null),this._path2D&&this._createShapePath(this._path2D,e,n)),null==this._path2D&&this._createShapePath(t,e,n),this._clip&&(null!=this._path2D?t.clip(this.path2D):t.clip()),null!=this.color&&(null!=this._path2D?t.fill(this._path2D):t.fill()),0!=this.borderWidth&&null!=this.borderColor&&(null!=this._path2D?t.stroke(this._path2D):t.stroke())}},{key:"_createShapePath",value:function(t,e,n){}}]),e}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=a(n(0)),o=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(t,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),null==t)throw new Error("Canvas不能为空");var i=t.getContext("2d");if(null==i)throw new Error("很遗憾,当前设备不支持Canvas2d。或者你看看是不是传入的canvas错了？");(n=n||{}).clip=!0;var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{}));return o._tempCanvas=n.tempCanvas,o.keep=n.keep,o.width=n.canvasWidth||t._width,o.height=n.canvasHeight||t._height,t.width=r.default.DRP*o.width,t.height=r.default.DRP*o.height,o.ctx=i,o.ctx.wx_canvas=t,o.canvas=t,o.ctx.scale(r.default.DRP,r.default.DRP),o._rafId,o._rafUpdateId,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"createImage",value:function(t){if(null==t)return null;var e=t.src,n=t.onload,i=t.onerror;if(null!=e){var r=this.canvas.createImage();r.onload=function(){n&&n(r)},r.onerror=i,r.src=e}else i&&i("src不能为空")}},{key:"createImageFigure",value:function(t){if(null==t)return null;var e=t.src,n=t.onload,i=t.onerror,r=null==t.width?0:t.width,a=null==t.height?0:t.height,s=this._tempCanvas;this.createImage({src:e,onload:function(e){if(n){var i=new o.default({mode:t.mode,image:e,width:r,height:a,tempCanvas:s});n(i)}},onerror:function(){i&&i("图片加载错误,输入路径为 ："+e)}})}},{key:"draw",value:function(t){null==this.keep&&t.clearRect(0,0,this.width,this.height),function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t)}},{key:"startRAF",value:function(t){if(null==this._rafId){var e=void 0,n=void 0;t&&(e=t.beforeDraw,n=t.afterDraw);var i=this.canvas,r=this;!function t(){e&&e(),r.update(!1),n&&n(),r._rafId=i.requestAnimationFrame(t)}()}}},{key:"endRAF",value:function(){null!=this._rafId&&(this.canvas.cancelAnimationFrame(this._rafId),this._rafId=null)}},{key:"update",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments[1];if(t){var n=this.ctx,i=this;this._rafUpdateId&&this.canvas.cancelAnimationFrame(this._rafUpdateId),this._rafUpdateId=this.canvas.requestAnimationFrame(function(){i.draw(n),i._rafUpdateId=null,e&&e()})}else this.draw(this.ctx)}},{key:"rAFisRunning",get:function(){return null!=this._rafId}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=null,o=null,a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._array=e||new Float32Array(6)}return i(t,[{key:"identity",value:function(){var t=this._array;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,this}},{key:"rotate",value:function(t){var e=this.data,n=Math.cos(t),i=Math.sin(t);return e[0]=n,e[1]=-i,e[2]=0,e[3]=i,e[4]=n,e[5]=0,this}},{key:"scale",value:function(t,e){var n=this.data;return n[0]=t,n[1]=0,n[2]=0,n[3]=0,n[4]=e,n[5]=0,this}},{key:"translate",value:function(t,e){var n=this.data;return n[0]=1,n[1]=0,n[2]=t,n[3]=0,n[4]=1,n[5]=e,this}},{key:"multiplyWithVertexDatas",value:function(t,e,n){null==n&&(n=new Float32Array(2));var i=this.data;return n[0]=i[0]*t+i[1]*e+i[2],n[1]=i[3]*t+i[4]*e+i[5],n}},{key:"multiplyWithVertex",value:function(t,e){return this.multiplyWithVertexDatas(t[0],t[1],e)}},{key:"multiplyWithDatas",value:function(t,e,n,i,r,o){var a=this.data,s=this.data,u=a[0],l=a[3],h=a[1],c=a[4],f=a[2],_=a[5];return s[0]=t*u+e*h,s[3]=t*l+e*c,s[1]=n*u+i*h,s[4]=n*l+i*c,s[2]=r*u+o*h+f,s[5]=r*l+o*c+_,this}},{key:"multiply",value:function(t){var e=t.data;return this.multiplyWithDatas(e[0],e[3],e[1],e[4],e[2],e[5])}},{key:"data",get:function(){return this._array}}],[{key:"copyFrom",value:function(t,e){var n=e.data,i=t.data;n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5]}},{key:"IdentityMatrix",value:function(e){return null==e&&(e=new Float32Array(6)),new t(e).identity()}},{key:"TEMP",get:function(){return null==r&&(r=new t).identity(),r}},{key:"TEMP2",get:function(){return null==o&&(o=new t,r.identity()),o}}]),t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=a(n(0)),o=a(n(2));function a(t){return t&&t.__esModule?t:{default:t}}var s="scaleToFill",u="center",l=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{};var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._image=t.image,n._mode=t.mode||s,n._position=t.position||u,n._tempCanvas=t.tempCanvas,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"setBoundsWithImageAspect",value:function(t){if(null!=this._image)if(null==t)this.width=this._image.width,this.height=this._image.height;else{var e=t.width,n=t.height,i=this._image.width,r=this._image.height;null!=e?(this.width=e,this.height=Math.floor(e*r/i)):null!=n&&(this.height=n,this.width=Math.floor(n*i/r))}}},{key:"_paintImage",value:function(t,e,n,i,r){if(this._mode!=s){if("aspectFill"==this._mode){var o=i,a=Math.floor(o*n/e);a>r&&(a=r,o=Math.floor(a*e/n));var u=Math.floor((i-o)/2),l=Math.floor((r-a)/2);return this._position,void t.drawImage(this._image,u,l,o,a,0,0,e,n)}if("aspectFit"!=this._mode);else{var h=e,c=Math.floor(h*r/i);c>n&&(c=n,h=Math.floor(c*i/r));var f=Math.floor((e-h)/2),_=Math.floor((n-c)/2);t.drawImage(this._image,f,_,h,c)}}else t.drawImage(this._image,0,0,e,n)}},{key:"_drawSelf",value:function(t,e,n){if(null!=this.image&&0!=this.width&&0!=this.height){var i=this._image.width,r=this._image.height,a=t;if(this._contentDirty)if(null!=this._tempCanvas){this._tempCanvas.width=e,this._tempCanvas.height=n;var s=this._tempCanvas.getContext("2d");this._paintImage(s,e,n,i,r),this._tempImage=this._tempCanvas.createImage();var u=this;this._tempImage.onload=function(){u._contentDirty=!1;var t=u.getRoot();t instanceof o.default&&t.update(!0)},this._tempImage.onerror=function(){console.error("临时canvas绘制生成image发生错误")},this._tempImage.src=this._tempCanvas.toDataURL()}else this._paintImage(t,e,n,i,r);else null!=this._tempImage&&a.drawImage(this._tempImage,0,0)}}},{key:"mode",get:function(){return this._mode},set:function(t){this._mode!=t&&(this._mode=t,this._contentDirty=!0)}},{key:"position",get:function(){return this._position},set:function(t){this._position!=t&&(this._position=t,this._contentDirty=!0)}},{key:"image",get:function(){return this._image},set:function(t){this._image!=t&&(this._image=t,this._contentDirty=!0)}}]),e}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=d(n(2)),o=d(n(0)),a=d(n(4)),s=d(n(7)),u=d(n(8)),l=d(n(9)),h=d(n(1)),c=d(n(10)),f=d(n(3)),_=d(n(11));function d(t){return t&&t.__esModule?t:{default:t}}var y={};!function t(e,n){var r=function(r){var o=e[r],a=o;"object"==(void 0===a?"undefined":i(a))&&t(o,a={}),Object.defineProperty(n,r,{get:function(){return a}})};for(var o in e)r(o)}({version:"0.0.1",Graph:r.default,Figure:o.default,image:{ImageFiguer:a.default},line:{Line:s.default},shapes:{Circle:u.default,Polygon:l.default,Shape:h.default,Rectangle:c.default},math:{Matrix3:f.default},text:{Text:_.default}},y),console.log("%c Graph(version 0.0.1) by 老脸","color:red;background-color:yellow"),e.default=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={isPointInPolygon:function(t,e,n){if(null==t||null==e||null==n)return!1;if(n.length<3)return!1;for(var i=n[0][0],r=n[0][0],o=n[0][1],a=n[0][1],s=1;s<n.length;s++){var u=n[s];i=Math.min(u[0],i),r=Math.max(u[0],r),o=Math.min(u[1],o),a=Math.max(u[1],a)}if(t<i||t>r||e<o||e>a)return!1;for(var l=!1,h=0,c=n.length-1;h<n.length;c=h++)n[h][1]>e!=n[c][1]>e&&t<(n[c][0]-n[h][0])*(e-n[h][1])/(n[c][1]-n[h][1])+n[h][0]&&(l=!l);return l}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0);(i=o)&&i.__esModule;var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this._hidden=null!=e.hidden&&e.hidden,this._points=e.points||[],this.color=e.color||"#000000",this.width=null==e.width?1:e.width,this.cap=e.cap||"round",this.join=e.join||"round",this.lineDash=e.lineDash||[],this.miterLimit=null==e.miterLimit?10:e.miterLimit,this.dashOffset=null==e.dashOffset?0:e.dashOffset,this._mode=e.mode||"direct",this._path2d,this._contentDirty=!0}return r(t,[{key:"addPoint",value:function(t){this._points.push(t),this._contentDirty=!0}},{key:"removePointAt",value:function(t){t<0||t>this._points.length-1||(this._points.splice(t,1),this._contentDirty=!0)}},{key:"removePoint",value:function(t){this.removePointAt(this._points.indexOf(t))}},{key:"_applyCurrentDrawingStates",value:function(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.cap,t.lineJoin=this.join,t.lineDashOffset=this.dashOffset,t.lineMiterLimit=this.miterLimit,t.setLineDash(this.lineDash)}},{key:"canDraw",value:function(){return null!=this.color&&0!=this.opacity&&0!=this.lineWidth&&!this.hidden}},{key:"draw",value:function(t){this.canDraw()&&(t.save(),this._applyCurrentDrawingStates(t),this._drawSelf(t),t.restore())}},{key:"_drawSelf",value:function(t){this._points.length<2||null!=this._points[0]&&(this._contentDirty&&(null==this._path2d&&(this._path2d=t.wx_canvas.createPath2D()),this._path2d&&this._createLine(this.path2d),this._contentDirty=!1),null!=this._path2d?t.stroke(this._path2d):(this._createLine(t),t.stroke()))}},{key:"_createLine",value:function(t){var e=this._points[0];if(t.beginPath(),"direct"==this._mode){t.moveTo(e.x,e.y);for(var n=1;n<this._points.length;n++){var i=this._points[n];t.lineTo(i.x,i.y)}}"curved"==this._mode&&this.bzCurve(t,this._points)}},{key:"_gradient",value:function(t,e){return(e.y-t.y)/(e.x-t.x)}},{key:"bzCurve",value:function(t,e,n,i){t.moveTo(e[0].x,e[0].y);for(var r=e[0],o=1;o<e.length;o++){var a=e[o];t.bezierCurveTo((r.x+a.x)/2,r.y,(a.x+r.x)/2,a.y,a.x,a.y),r=a}}},{key:"mode",get:function(){return this._mode},set:function(t){this._mode!=t&&(this._mode=t,this._contentDirty=!0)}},{key:"hidden",get:function(){return this._hidden},set:function(t){this._hidden=t}},{key:"points",get:function(){return this._points}}]),t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=a(n(1)),o=a(n(0));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{};var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._radius=null==t.radius?0:t.radius,n._angle=null==t.angle?360:t.angle,n._center,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"_createShapePath",value:function(t,e,n){t.beginPath();var i=this.radius;if(Math.abs(this._angle)>=360)t.arc(i,i,this.radius,0,2*Math.PI);else{t.moveTo(i,i);var r=this.angle<0;t.arc(i,i,this.radius,0,this._angle*o.default.PIDIV180,r)}t.closePath()}},{key:"width",set:function(t){},get:function(){return 2*this.radius}},{key:"height",set:function(t){},get:function(){return 2*this.radius}},{key:"angle",get:function(){return this._angle},set:function(t){this._angle!=t&&(this._angle=t,Math.abs(this._angle)>=360&&(this._angle<0?this._angle=-360:this._angle=360),this._contentDirty=!0)}},{key:"radius",get:function(){return this._radius},set:function(t){this._radius!=t&&(this._radius=t,this._contentDirty=!0)}},{key:"center",get:function(){return this._center||(this._center={x:0,y:0}),this._center.x=this.x+this._radius,this._center.y=this.y+this._radius,this._center}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{};var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._close=null==t.close||t.close,n._points=t.points||[],n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"addPoint",value:function(t){this._points.push(t),this._contentDirty=!0}},{key:"removePointAt",value:function(t){this._points.splice(t,1),this._contentDirty=!0}},{key:"canDraw",value:function(){return this._points.length>=3&&function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"canDraw",this).call(this)}},{key:"_createShapePath",value:function(t,e,n){t.beginPath();var i=this._points;t.moveTo(i[0][0],i[0][1]);for(var r=1;r<i.length;r++){var o=i[r];t.lineTo(o[0],o[1])}this.close&&t.closePath()}},{key:"points",get:function(){return this._points}},{key:"close",get:function(){return this._close},set:function(t){this._close!=t&&(this._close=t,this._contentDirty=!0)}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),a=(i=o)&&i.__esModule?i:{default:i};var s=Math.PI/2,u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{};var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._radius=null==t.radius?0:t.radius,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),r(e,[{key:"_createShapePath",value:function(t,e,n){if(t.beginPath(),0==this.radius)t.rect(0,0,e,n);else{var i=Math.min(e,n);if(this.radius>i/2)throw new Error("圆角矩形半径怎么可能大于它的宽度或者长度一半呢?");var r=this.radius;t.moveTo(r,0),t.lineTo(e-r,0),t.arc(e-r,r,r,-s,0),t.lineTo(e,n-r),t.arc(e-r,n-r,r,0,s),t.lineTo(r,n),t.arc(r,n-r,r,s,Math.PI),t.lineTo(0,r),t.arc(r,r,r,Math.PI,Math.PI+s)}t.closePath()}},{key:"radius",get:function(){return this._radius},set:function(t){this._radius!=t&&(this._radius=t,this._contentDirty=!0)}}]),e}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(0),s=(i=a)&&i.__esModule?i:{default:i};var u="left",l="top",h=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{};var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._text=t.text,n._fontFamily=t.fontFamily||"arial",n._fontSize=null==t.fontSize?16:t.fontSize,n._fontWeight=t.fontWeight||"normal",n._fontStyle=t.fontStyle||"",n.maxWidth=t.maxWidth,n._color=t.color||"#0e0e0e",n._borderColor=t.borderColor,n._borderWidth=null==t.borderWidth?0:t.borderWidth,n._width=0,n.align=t.align||u,n.baseLine=t.baseLine||l,n.lineHeight=null==t.lineHeight?1.5:t.lineHeight,n._textArray=[],n._textDirty=!0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),r(e,[{key:"getVertex",value:function(){var t=0,e=0,n=this.width,i=this.height;return"center"==this.align&&(t=-n/2),"right"==this.align&&(t=-n),"middle"==this.baseline&&(e=-i/2),"bottom"==this.baseline&&(e=-i),[[t,e],[t+n,e],[t+n,e+i],[t,e+i]]}},{key:"_getTextArray",value:function(){return this._textDirty&&(this._textArray=this._text.split("\n"),this._textDirty=!1),this._textArray}},{key:"addLine",value:function(t){this._text+="\n"+t,this._textArray.push(t),this._contentDirty=!0,this._textDirty=!1}},{key:"removeLine",value:function(t){if(!(t<0||t>this._textArray.length-1)){this._textArray.splice(t,1),this._text="";for(var e=0;e<this._textArray.length;e++){var n=this._textArray[e];this._text+=n,e!=this._textArray.length-1&&(this._text+="\n")}this._contentDirty=!0,this._textDirty=!1}}},{key:"canDraw",value:function(){return null!=this._text&&0!=this._text.length&&o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"canDraw",this).call(this)}},{key:"_applyCurrentDrawingStates",value:function(t){t.font=this.font,t.fillStyle=this.color,t.textBaseline="top",t.textAlign=this.align,t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_applyCurrentDrawingStates",this).call(this,t)}},{key:"_drawSelf",value:function(t,e,n){t.save();var i=this._getTextArray(),r=0;if(this.baseLine==l&&(r=0),"middle"==this.baseLine&&(r=-n/2),"bottom"==this.baseLine&&(r=-n),null!=this.maxWidth)for(var o=0;o<i.length;o++){var a=i[o];t.fillText(a,0,r,this.maxWidth),0!=this.borderWidth&&null!=this.borderColor&&t.strokeText(a,0,r,this.maxWidth),r+=this.fontSize*this.lineHeight}else for(var s=0;s<i.length;s++){var u=i[s];t.fillText(u,0,r),0!=this.borderWidth&&null!=this.borderColor&&t.strokeText(u,0,r),r+=this.fontSize*this.lineHeight}t.restore()}},{key:"color",get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t)}},{key:"borderColor",get:function(){return this._borderColor},set:function(t){this._borderColor!=t&&(this._borderColor=t)}},{key:"borderWidth",get:function(){return this._borderWidth},set:function(t){this._borderWidth!=t&&(this._borderWidth=t)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!=t&&(this._fontStyle=t,this._contentDirty=!0)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this._fontFamily!=t&&(this._fontFamily=t,this._contentDirty=!0)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!=t&&(this._fontSize=t,this._contentDirty=!0)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!=t&&(this._fontWeight=t,this._contentDirty=!0)}},{key:"font",get:function(){return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px "+this.fontFamily}},{key:"width",set:function(t){},get:function(){if(this._contentDirty){if(""==this._text&&null==this._text)return 0;var t=this.getRoot();if(null!=t&&t.ctx){t.ctx.save(),t.ctx.font=this.font;for(var e=this._getTextArray(),n=-1/0,i=0;i<e.length;i++){var r=e[i];n=Math.max(t.ctx.measureText(r).width,n)}this._width=n,t.ctx.restore(),this._contentDirty=!1}}return null!=this.maxWidth?Math.min(this._width,this.maxWidth):this._width}},{key:"height",set:function(t){},get:function(){return this._fontSize*this.lineHeight*this._getTextArray().length}},{key:"text",get:function(){return this._text},set:function(t){this._text!=t&&(this._text=t,this._contentDirty=!0,this._textDirty=!0)}}]),e}();e.default=h}]).default});